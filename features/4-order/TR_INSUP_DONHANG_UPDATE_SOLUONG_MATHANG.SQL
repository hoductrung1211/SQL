ALTER TRIGGER TR_INSUP_DONHANG_UPDATE_SOLUONG_MATHANG
ON DONHANG AFTER INSERT, UPDATE
AS BEGIN 
    UPDATE MATHANG 
    SET SOLUONG = MH.SOLUONG + TMP_CTDH.SOLUONG
    FROM MATHANG MH 
    INNER JOIN (
        SELECT 
            CT_DONHANG.MAMH,
            CT_DONHANG.SOLUONG
        FROM inserted 
        INNER JOIN CT_DONHANG
            ON inserted.MADH = CT_DONHANG.MADH
            AND inserted.MATT_DH = 6 -- HUY
    ) TMP_CTDH
        ON MH.MAMH = TMP_CTDH.MAMH
END;